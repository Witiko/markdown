\def\markdownOptionGfmAutoIdentifiers{true}
\def\markdownOptionHeaderAttributes{true}
<<<
This test ensures that the Lua `gfmAutoIdentifiers` and `headerAttributes` options
correctly propagate through the plain TeX interface.

Non-alphanumeric characters besides _- are ignored:

# abc @#$ _-

Non-alphanumeric at the start are not skipped (compared to auto identifiers):

# 123 . abc

Runs of spaces are replaced with hyphens:

# a b  c   d

Newlines are replaced with hyphens as well:

a
b
c
=

Trailing whitespace is removed:

# this ends with spaces   

If no content remains, the default identifier "section" is assigned:

# .

If the same identifier is created, the new one is distinguished by an index.

This is just "a":

# a

This is "a-2":

# a

This is "a-3":

# a

This heading already has an id:

# abc {#id}

So does this one:

a
b
c {#id}
=

An auto identifier must be unique even regarding explicit indentifiers, 
although duplicate explicit identifiers count only once:

# a {#one}

# a {#one}

This, therefore, only gets "one-1", not "one-2":

# one

Unicode is supported:

# Ěščřžýáíé
>>>
documentBegin
codeSpan: gfmAutoIdentifiers
codeSpan: headerAttributes
softLineBreak
interblockSeparator
underscore
interblockSeparator
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: abc-_-
headingOne: abc @(hash)(dollarSign) (underscore)-
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: 123-abc
headingOne: 123 . abc
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: a-b-c-d
headingOne: a b  c   d
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: a-b-c
headingOne: a(softLineBreak)b(softLineBreak)c
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: this-ends-with-spaces
headingOne: this ends with spaces
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: section
headingOne: .
END headerAttributeContext
interblockSeparator
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: a
headingOne: a
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: a-1
headingOne: a
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: a-2
headingOne: a
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: id
headingOne: abc
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: id
headingOne: a(softLineBreak)b(softLineBreak)c
END headerAttributeContext
interblockSeparator
softLineBreak
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: one
headingOne: a
END headerAttributeContext
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: one
headingOne: a
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: one-1
headingOne: one
END headerAttributeContext
interblockSeparator
interblockSeparator
END section
BEGIN section
BEGIN headerAttributeContext
attributeIdentifier: ěščřžýáíé
headingOne: Ěščřžýáíé
END headerAttributeContext
END section
documentEnd
